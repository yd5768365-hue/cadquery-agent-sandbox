# CadQuery Agent Sandbox

一个基于 Cherry Studio 构建的高度工程化 AI Agent 系统，专注于 CadQuery 参数化建模,仿真模拟,分析零件的强度。系统通过 MCP (Model Context Protocol) 提供工具化接口，让智能体能安全地读取/写入文件、运行代码并在受控的 Docker 沙盒中执行反馈循环，并且使用docker容器里面镜像的工具库,从而自动修复错误并迭代生成可靠的零件。

🌟 本项目的核心亮点
- 闭环自进化：AI 能够在沙盒内运行代码（/bin/bash / Python），读取运行输出与报错，并根据反馈自动修复模型脚本。  
- 沙盒隔离（安全优先）：所有代码执行都在 Docker 容器内,避免在进行仿真模拟,网格计算,动态数据分析时,。  
- 权威知识对齐：预先注入 CadQuery 官方文档与示例，显著降低 LLM 产生“幻觉”的概率，保证 API 调用的准确性。  
- 工程化 Prompt & SOP：内置工程哲学与作业流程（SOP），使输出具有一致性、可复现性与可审计性。  
- 面向修改与协作：生成的 CAD 代码遵循模块化和可维护的风格，便于后续人工审查与团队协作。  
- 标准零件库集成：已导入 cq_warehouse 标准零件库，包含常用标准件与参数化零件（如螺栓、螺母、销钉等），可直接在生成脚本中调用，极大提升组装与建模效率。
- 仿真模拟工具已经配置完成: 已经配置好仿真模拟需要的工具的容器环境,智能体可以通过调用工具进行仿真模拟
- 特性,说明
🔄闭环自进化,人工智能
🧪仿真与验证,(新)容器内部集成仿真模拟工具，Agent可在建模后直接运行物理/结构模拟，验证设计合理性。
🛡️沙盒隔离,图片：Docker内部，保护了起重机械的影响。
📚权威知识扫描,预先注入CadQuery文档与示例，降低LLM“幻觉”，保证API调用的准确性。
⚙️工程化SOP,图片可能已被使用。
🔩 标准件库集成,集成cq_warehouse，支持直接调用标准件（如零件、轴承），提升效率。

---

## 系统架构（概览）
1. 用户在 Cherry Studio 提出建模需求与约束。  
2. DeepSeek（或其它 LLM）结合 CadQuery 文档进行推理与代码生成。  
3. 通过 MCP（Model Context Protocol）调用工具：
   - read_file：读取仓库上下文、模型脚本与文档；  
   - write_file：创建或覆盖建模脚本；  
   - run_code：在 Docker 容器中执行 Python/CQ 脚本并收集日志；  
   - bash_access：有限的系统级准备命令（受权限控制）。
4. 反馈闭环：解析容器输出，若失败则触发自动修复流程，直到成功或达到上限。

简化流程图：  
User → Cherry Studio → LLM(DeepSeek) → MCP Tools (read/write/run/bash) → Docker Sandbox → Logs → LLM（修复/交付）

---

## 为什么选择本项目
- 为 CadQuery 建模打造的专属自动化工作流，适合快速验证参数化想法并生成可复用脚本。  
- 面向教育与工程实践：适合作为课程示例、项目原型与公司内部自动化建模流程的基础设施。  
- 安全与可审计：把自动化能力置于可控沙盒与日志之下，便于审查每一步的变更。  
- 提高效率：将重复性的试错环节交由自动化闭环处理，把精力留给更高层次的设计决策。

---

## 快速开始（建议步骤）
先决条件
- 安装 Cherry Studio（本项目在 Cherry Studio 中运行/集成）  
- 安装 Docker（用于沙盒执行）  
- 获取 DeepSeek API Key 或其他 LLM Key（用于推理/生成）

依赖与标准零件库
- 本项目已集成 cq_warehouse 标准零件库，用于快速调用常用标准件与参数化零件，帮助你更快完成装配与验证。  
- 安装/导入方式示例：请参照项目内 docs 或直接在执行环境中通过 pip/源码安装该库（不同环境可能略有差异）。  
- 在 CadQuery 脚本中可直接引用库中的零件，例如：
  - from cq_warehouse.fasteners import MetricBolt  # 示例（具体模块名请参见 cq_warehouse 文档）
  - bolt = MetricBolt(diameter=4, length=16)

配置与启动（示例）
1. 克隆仓库  
   git clone https://github.com/yd5768365-hue/cadquery-agent-sandbox.git
2. 在仓库根目录创建配置文件（例如 `.env`），填入 DeepSeek/LLM 的 API Key 与必要配置。  
3. 启动 MCP 服务（项目中包含服务脚本）  
   - 启动容器或本地服务（详见项目 scripts 或 docs）  
4. 在 Cherry Studio 中导入/加载提示词（Prompts）与模型上下文。  
5. 提交第一个建模任务（示例）：  
   - 输入： “生成一个参数化的齿轮，模数 = 2，齿数 = 24，孔径 = 8mm，带布线孔”  
   - 系统会返回 CadQuery 脚本文件、渲染预览（如果可用）和运行日志。

（后续会补充更详细的启动脚本与示例步骤）

---

## 示例交付风格（约定）
- 模块化：每个模型放在独立的脚本文件，清晰的参数接口与注释。  
- 可重复：脚本应能在相同依赖下重现结果（记录依赖版本）。  
- 可审计：每次 run_code 的输出日志会与生成代码一并存档，便于回溯与回顾。  
- 权限优先：未经明确授权，Agent 不会执行越权操作或访问敏感资源。

---

## 作者与动机（关于我）
我是项目的作者，目前是一名大学一年级学生。我的学习路径有些特别：  
- 大一上学期：学习互联网金融，接触了数据与系统思维；  
- 大一下学期：转到机械设计及其自动化，开始系统地接触 CAD、机械制图与参数化建模。  

在跨学科学习的过程中，我发现传统的建模与验证方式效率很低——尝试、修改、重新运行、再修复，这个循环既耗时又容易出错。为了把更多时间用在设计思考与创新上，我决定用自动化和智能体的方式来改进流程，因此诞生了 CadQuery Agent Sandbox。这个项目是我把两门学科的想法结合起来的尝试：用编程和自动化来加速机械设计的迭代，降低重复工作量。

我还在学习和成长中，欢迎大家批评指正、提出建议或一起贡献代码——你的每一点帮助对我意义重大。

---

## 贡献指南
非常感谢你的关注与支持！欢迎贡献想法、Issue 或 PR。  
想帮助的话：  
- 点个 Star，能极大提升项目被看到的概率 ⭐  
- 提交 Issue：功能建议、Bug 报告、使用体验  
- 提交 PR：文档改进、示例补充、容器配置优化  
- 教学/示例：如果你有 CadQuery 的实际案例，欢迎贡献作为示例

联系方式：  
- 在仓库打开 Issue  
- 或者直接发 Pull Request

---

## 未来计划（Roadmap）
- 补全一键式本地运行脚本与 Docker Compose 配置  
- 增加更多 CadQuery 建模范例与单元测试  
- 支持更多 LLM 后端并提供本地化的模型适配示例  
- 可视化 Web 界面（在 Cherry Studio 内更好的交互体验）  
- 教学系列：把我的学习过程与示例整理成教程，帮助刚入门的同学快速上手

---

## 致谢与许可
感谢 CadQuery 社区、Cherry Studio 项目以及所有对我这个小项目给予建议的人。  
当前仓库采用 MIT 许可（如需更改，请更新 LICENSE）。
